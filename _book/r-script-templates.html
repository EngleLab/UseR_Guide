<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 R Script Templates | EngleLab: useRguide</title>
<meta name="author" content="Jason Tsukahara">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EngleLab: useRguide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to the EngleLab useRguide</a></li>
<li class="book-part">Getting Started in R</li>
<li><a class="" href="installation.html"><span class="header-section-number">1</span> Installation</a></li>
<li><a class="" href="basic-r.html"><span class="header-section-number">2</span> Basic R</a></li>
<li><a class="" href="intermediate-r.html"><span class="header-section-number">3</span> Intermediate R</a></li>
<li class="book-part">Working with Data</li>
<li><a class="" href="working-with-data-overview.html">Working with Data: Overview</a></li>
<li><a class="" href="importing-and-outputing-data.html"><span class="header-section-number">4</span> Importing and Outputing Data</a></li>
<li><a class="" href="data-manipulation-using-dplyr.html"><span class="header-section-number">5</span> Data Manipulation using dplyr</a></li>
<li><a class="" href="common-data-manipulations.html"><span class="header-section-number">6</span> Common Data Manipulations</a></li>
<li class="book-part">Reproducible Workflows</li>
<li><a class="" href="reproducible-workflows-overview.html">Reproducible Workflows: Overview</a></li>
<li><a class="" href="project-organization.html"><span class="header-section-number">7</span> Project Organization</a></li>
<li><a class="" href="reproducible-practices.html"><span class="header-section-number">8</span> Reproducible Practices</a></li>
<li><a class="active" href="r-script-templates.html"><span class="header-section-number">9</span> R Script Templates</a></li>
<li class="book-part">Create R Scripts</li>
<li><a class="" href="create-r-scripts-overview.html">Create R Scripts: Overview</a></li>
<li><a class="" href="data-preparation-setup.html"><span class="header-section-number">10</span> Data Preparation: Setup</a></li>
<li><a class="" href="data-preparation-messy-to-tidy.html"><span class="header-section-number">11</span> Data Preparation: Messy to Tidy</a></li>
<li><a class="" href="data-analysis-setup.html"><span class="header-section-number">12</span> Data Analysis: Setup</a></li>
<li><a class="" href="data-analysis-tidy-to-scored.html"><span class="header-section-number">13</span> Data Analysis: Tidy to Scored</a></li>
<li><a class="" href="data-analysis-single-merged-file.html"><span class="header-section-number">14</span> Data Analysis: Single Merged File</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="data-visualization-overview.html">Data Visualization: Overview</a></li>
<li><a class="" href="fundamentals-of-data-visualization.html"><span class="header-section-number">15</span> Fundamentals of Data Visualization</a></li>
<li><a class="" href="introduction-to-ggplot2.html"><span class="header-section-number">16</span> Introduction to ggplot2</a></li>
<li><a class="" href="scatterplots.html"><span class="header-section-number">17</span> Scatterplots</a></li>
<li><a class="" href="plotting-means.html"><span class="header-section-number">18</span> Plotting Means</a></li>
<li><a class="" href="univariate-plots.html"><span class="header-section-number">19</span> Univariate Plots</a></li>
<li class="book-part">Statistical Analysis</li>
<li><a class="" href="statistical-analysis-overview.html">Statistical Analysis: Overview</a></li>
<li><a class="" href="statistics-in-r.html"><span class="header-section-number">20</span> Statistics in R</a></li>
<li><a class="" href="structural-equation-modelling.html"><span class="header-section-number">21</span> Structural Equation Modelling</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-script-templates" class="section level1">
<h1>
<span class="header-section-number">9</span> R Script Templates<a class="anchor" aria-label="anchor" href="#r-script-templates"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/workflows/workflow_all.png" width="60%" style="display: block; margin: auto;"></div>
<p><br></p>
<p>One of the nice features of using R scripts to analyze your data is that you can use a lot of the same code from one step or one project to another.</p>
<p>For each of these steps, the script organization from one task, analysis, or project to the next will be more or less the same. This means we can take advantage of using R script templates. Using R Script templates will not just save time but help you stay organized and use reproducibility practices talked about in the previous chapters.</p>
<div id="install-workflow-package" class="section level2">
<h2>
<span class="header-section-number">9.1</span> Install <code>workflow</code> package<a class="anchor" aria-label="anchor" href="#install-workflow-package"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb200"><pre class="downlit">
<span class="kw">devtools</span>::<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"dr-JT/workflow"</span>)
</pre></div>
<p>I have created some templates you can easily download using a single R function <code>workflow::template()</code></p>
<p>There are different types of templates you can download using <code>workflow::template()</code>. You can always use <code>?workflow::template</code> to see help documentation.</p>
<div id="data-preparation-1" class="section level3">
<h3>
<span class="header-section-number">9.1.1</span> Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation-1"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="images/workflows/workflow_messy-tidy.png" width="40%" style="display: block; margin: auto;"></div>
<p><em>Data Preparation</em> will occur in a Data Collection directory, separately from <em>Data Analysis</em>. It will have its own <strong>.RProj</strong> and <strong>mastercript.R</strong> files.</p>
<p>The main purpose of data preparation is converting <em>messy</em> raw data files to <em>tidy</em> raw data files.</p>
</div>
<div id="messy-to-tidy-script" class="section level3">
<h3>
<span class="header-section-number">9.1.2</span> messy-to-tidy script<a class="anchor" aria-label="anchor" href="#messy-to-tidy-script"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to download a template script for the step of converting <em>messy</em> raw data files to <em>tidy</em> raw data files during data preparation you can simply specify:</p>
<div class="sourceCode" id="cb201"><pre class="downlit">
<span class="kw">workflow</span>::<span class="fu">template</span>(rawscript = <span class="fl">TRUE</span>)
</pre></div>
<p>Let us take a look at what the <strong>rawscript</strong> template looks like</p>
<div class="sourceCode" id="cb202"><pre class="downlit">
<span class="co">#### Setup ####</span>
<span class="co">## Load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/krlmlr/here">here</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://readr.tidyverse.org">readr</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)

<span class="co">## Set Import/Output Directories</span>
<span class="kw">import_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files/Merged"</span>
<span class="kw">output_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files"</span>

<span class="co">## Set Import/Output Filenames</span>
<span class="kw">task</span> <span class="op">&lt;-</span> <span class="st">"taskname"</span>
<span class="kw">import_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">task</span>, <span class="st">".txt"</span>, sep = <span class="st">""</span>)
<span class="kw">output_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">task</span>, <span class="st">"raw.csv"</span>, sep = <span class="st">"_"</span>)
<span class="co">################</span>

<span class="co">#### Import ####</span>
<span class="kw">data_import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">import_dir</span>, <span class="kw">import_file</span>), <span class="st">"\t"</span>, 
                          escape_double = <span class="fl">FALSE</span>, trim_ws = <span class="fl">TRUE</span>,
                          guess_max = <span class="fl">10000</span>)
<span class="co">################</span>

<span class="co">#### Tidy raw data ####</span>
<span class="kw">data_raw</span> <span class="op">&lt;-</span> <span class="kw">data_import</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>() <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span>() <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>() <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>()
<span class="co">#######################</span>

<span class="co">#### Output ####</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="kw">data_raw</span>, <span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">output_dir</span>, <span class="kw">output_file</span>))
<span class="co">################</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
</pre></div>
<p>There are 4 main blocks of R code:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Set up</strong> the script</p>
<ul>
<li>Load required packages using <code>library()</code>
</li>
<li>Set the import/output directories and filenames</li>
</ul>
<p>Doing these steps at the top of the script makes it obvious, without having to read the rest of the script, what packages the script will require and what data file it is importing and outputing.</p>
</li>
<li><p><strong>Import</strong> a data file using <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> from the <code>readr</code> package</p></li>
<li>
<p><strong>Tidy</strong> the imported data frame using <code>dplyr</code> functions, such as</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code></p>
</li>
<li><p><strong>Output</strong> a “tidy” data file using <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> from <code>readr</code></p></li>
</ol>
<p>Last, remove all objects from the environment with <code><a href="https://rdrr.io/r/base/rm.html">rm(list=ls())</a></code>.</p>
<p><br></p>
<p>To me this template is beautiful. The only thing you need to change is</p>
<ol style="list-style-type: decimal">
<li><p><code>task &lt;- "taskname"</code> to the name of the task used in the file name</p></li>
<li><p>Fill in what happens in the <em>Tidy raw data</em> block.</p></li>
</ol>
<p>The rest can LITERALLY stay the same. How easy!</p>
</div>
<div id="masterscript-data-preparation" class="section level3">
<h3>
<span class="header-section-number">9.1.3</span> masterscript: Data Preparation<a class="anchor" aria-label="anchor" href="#masterscript-data-preparation"><i class="fas fa-link"></i></a>
</h3>
<p>In the EngleLab, we often have up to 40 tasks for a single Data Collection study. When you have a lot of R Scripts it is quite tedious to open, <strong>Source</strong>, and exit, each R script one at a time. The <strong>masterscript</strong> allows you to <strong>Source</strong> all of your scripts at once.</p>
<p>The <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> function is a way to execute all the lines of code in a script file. Rather than having to manually open each script file and sourcing it from there you can control your entire data processing workflow from the masterscript using <code><a href="https://rdrr.io/r/base/source.html">source()</a></code>. The argument <code>echo = TRUE</code> will print the results of the script to the console that way you can still see what the script is doing.</p>
<p>This allows you to run each script from the masterscript and control the order in which you run them. For Data Preparation the order does not really matter, but once you get to Data Analysis the order is crucial.</p>
<p>The masterscript template for <em>Data Preparation</em> can be downloaded with:</p>
<div class="sourceCode" id="cb203"><pre class="downlit">
<span class="kw">workflow</span>::<span class="fu">template</span>(masterscript = <span class="st">"data preparation"</span>)
</pre></div>
<p>This masterscript is simple:</p>
<div class="sourceCode" id="cb204"><pre class="downlit">
<span class="co">## Data Preparation for Study Name</span>

<span class="co">#############################################</span>
<span class="co">#------ 0. "messy" to "tidy" raw data ------#</span>
<span class="co">#############################################</span>

<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"R Scripts/0_taskname_raw.R"</span>, echo=<span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="co">#############################################</span>
</pre></div>
</div>
</div>
<div id="data-analysis-1" class="section level2">
<h2>
<span class="header-section-number">9.2</span> Data Analysis<a class="anchor" aria-label="anchor" href="#data-analysis-1"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-figure"><img src="images/workflows/workflow_dataanalysis.png" width="45%" style="display: block; margin: auto;"></div>
<p><em>Data Analysis</em> will occur in it’s own directory separate from the Data Collection directory and separate from <em>Data Preparation</em>. The tidy raw data files created during <em>Data Preparation</em> will be copy and pasted over to <strong>Data Files/Raw Data</strong> in the <em>Data Analysis</em> directory</p>
<p>Typically there are at least two steps that need to be taken in order to create a final data file that is ready for statistical analysis.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Clean and Score</strong> the data from each task by aggregating performance over trials and removing any outlier trials or problematic/poor performing subjects.</p></li>
<li><p><strong>Merge</strong> the scored data file from each task into one final data file ready for statistical analysis.</p></li>
</ol>
<p>There may be some additional steps that are required but these are the basic ones.</p>
<div id="clean-and-score-script" class="section level3">
<h3>
<span class="header-section-number">9.2.1</span> clean and score script<a class="anchor" aria-label="anchor" href="#clean-and-score-script"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to download a template script for the step of cleaning and scoring a raw data file you can type in the console:</p>
<div class="sourceCode" id="cb205"><pre class="downlit">
<span class="kw">workflow</span>::<span class="fu">template</span>(scorescript = <span class="fl">TRUE</span>)
</pre></div>
<p>Let us take a look at what the <strong>scorescript</strong> template looks like</p>
<div class="sourceCode" id="cb206"><pre class="downlit">
<span class="co">#### Setup ####</span>
<span class="co">## Load Packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/krlmlr/here">here</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://readr.tidyverse.org">readr</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)

<span class="co">## Set Import/Output Directories</span>
<span class="kw">import_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files/Raw Data"</span>
<span class="kw">output_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files/Scored Data"</span>

<span class="co">## Set Import/Output Filenames</span>
<span class="kw">task</span> <span class="op">&lt;-</span> <span class="st">"taskname"</span>
<span class="kw">import_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">task</span>, <span class="st">"raw.csv"</span>, sep = <span class="st">"_"</span>)
<span class="kw">output_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">task</span>, <span class="st">"Scores.csv"</span>, sep = <span class="st">"_"</span>)

<span class="co">## Set Data Cleaning Params</span>

<span class="co">###############</span>

<span class="co">#### Import ####</span>
<span class="kw">data_import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">import_dir</span>, <span class="kw">import_file</span>))
<span class="co">################</span>

<span class="co">#### Data Cleaning and Scoring ####</span>
<span class="kw">data_scores</span> <span class="op">&lt;-</span> <span class="kw">data_import</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>() <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>() <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>()
<span class="co">###################################</span>

<span class="co">#### Output ####</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="kw">data_scores</span>, <span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">output_dir</span>, <span class="kw">output_file</span>))
<span class="co">################</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
</pre></div>
<p>Like the rawscript, there are 4 main blocks of R code:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Set up</strong> the script</p>
<ul>
<li>Load required packages using <code>library()</code>
</li>
<li>Set the import/output directories and filenames</li>
<li>Set Data Cleaning Params</li>
</ul>
<p>You can set some optional data cleaning parameters at the top of the script. This will be explained in more detail in the next section.</p>
</li>
<li><p><strong>Import</strong> a data file using <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> from the <code>readr</code> package</p></li>
<li>
<p><strong>Clean and Score</strong> the imported data frame using <code>dplyr</code> functions, such as</p>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code></p>
</li>
<li><p><strong>Output</strong> a data file with task <em>Scores</em> using <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> from <code>readr</code></p></li>
</ol>
<p>Last, remove all objects from the environment with <code><a href="https://rdrr.io/r/base/rm.html">rm(list=ls())</a></code>.</p>
<p><br></p>
<p>The parts you may need to change are:</p>
<ol style="list-style-type: decimal">
<li><p>What packages are loaded, <code>library()</code></p></li>
<li><p>task &lt;- “taskname”</p></li>
<li><p>Optional data cleaning parameters in the “Set Data Cleaning Params” section</p></li>
<li><p>The “Data Cleaning and Scoring” block</p></li>
</ol>
</div>
<div id="merge-script" class="section level3">
<h3>
<span class="header-section-number">9.2.2</span> merge script<a class="anchor" aria-label="anchor" href="#merge-script"><i class="fas fa-link"></i></a>
</h3>
<p>To download a template script to merge several Scored data files together:</p>
<div class="sourceCode" id="cb207"><pre class="downlit">
<span class="kw">workflow</span>::<span class="fu">template</span>(mergescript = <span class="fl">TRUE</span>)
</pre></div>
<p>The template looks like this:</p>
<div class="sourceCode" id="cb208"><pre class="downlit">
<span class="co">#### Set up ####</span>
<span class="co">## Load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/krlmlr/here">here</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/dr-JT/datawrangling">datawrangling</a></span>) <span class="co"># for files_join() and trim()</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)

<span class="co">## Set import/output directories</span>
<span class="kw">import_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files/Scored Data"</span>
<span class="kw">output_dir</span> <span class="op">&lt;-</span> <span class="st">"Data Files"</span>
<span class="kw">output_file</span> <span class="op">&lt;-</span> <span class="st">"name_of_datafile.csv"</span>
<span class="co">################</span>

<span class="co">#### Import Files ####</span>
<span class="kw">data_import</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dr-jt.github.io/datawrangling//reference/files_join.html">files_join</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">import_dir</span>), pattern = <span class="st">"Scores"</span>, id = <span class="st">"Subject"</span>)
<span class="co">######################</span>

<span class="co">#### Select only important variables ####</span>
<span class="kw">data_merge</span> <span class="op">&lt;-</span> <span class="kw">data_import</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>()

<span class="co">## Create list of final subjects</span>
<span class="kw">subj.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">data_merge</span>, <span class="kw">Subject</span>)
<span class="co">#################################################################</span>

<span class="co">#### Output ####</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="kw">data_merge</span>, <span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">output_dir</span>, <span class="kw">output_file</span>))
<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="kw">subj.list</span>, <span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="kw">output_dir</span>, <span class="st">"subjlist_final.csv"</span>))
<span class="co">################</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
</pre></div>
<p>Again, this template script has 4 main blocks:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Set up</strong> the script</p>
<ul>
<li>Load required packages using <code>library()</code>
</li>
<li>Set the import/output directories</li>
</ul>
<p>Notice that in the setup section, the import and output filenames are not specified. The import file names are not specified because 1) we may need to import quite a lot of Scored data files and 2) I created a function to do this without having to specify each individual filename. You could add a section to include an output filename if you want.</p>
</li>
<li>
<p><strong>Import</strong> the data files with task scores.</p>
<p>You can merge multiple files with the same rows (Subjects) and different columns (variables or task scores) using <code><a href="https://dr-jt.github.io/datawrangling//reference/files_join.html">datawrangling::files_join()</a></code>. This will be explained in more detail later on.</p>
</li>
<li>
<p><strong>Select</strong> only relevant variables.</p>
<p>It is likely that the individual Scored data files will have way more columns of scores than you are interested in.</p>
</li>
<li>
<p><strong>Output</strong> a final data file that is ready for statistical analysis with <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> from <code>readr</code></p>
<p>Optional to also create a file with a list of all subjects that have made it through all these stages of processing.</p>
</li>
</ol>
<p>Last, remove all objects from the environment with <code><a href="https://rdrr.io/r/base/rm.html">rm(list=ls())</a></code>.</p>
</div>
<div id="masterscript-data-analysis" class="section level3">
<h3>
<span class="header-section-number">9.2.3</span> masterscript: Data Analysis<a class="anchor" aria-label="anchor" href="#masterscript-data-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>The masterscript template for <em>Data Analysis</em> can be downloaded with:</p>
<div class="sourceCode" id="cb209"><pre class="downlit">
<span class="kw">workflow</span>::<span class="fu">template</span>(masterscript = <span class="st">"data analysis"</span>)
</pre></div>
<div class="sourceCode" id="cb210"><pre class="downlit">
<span class="co">## Data Analysis for StudyName</span>


<span class="co">#################################################</span>
<span class="co">#------ 1. "tidy" raw data to Scored data ------#</span>
<span class="co">#################################################</span>

<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"R Scripts/1_taskname_score.R"</span>, echo=<span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="co">#############################################################</span>
<span class="co">#------ 2. Create Final Merged Data File for Analysis ------#</span>
<span class="co">#############################################################</span>

<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"R Scripts/2_merge.R"</span>, echo=<span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="co">###############################</span>
<span class="co">#------ 3. Data Analysis ------#</span>
<span class="co">###############################</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/rstudio/rmarkdown">rmarkdown</a></span>)

<span class="fu"><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render</a></span>(<span class="st">"R Scripts/3_MainAnalyses.Rmd"</span>,
       output_dir = <span class="st">"Results"</span>, 
       output_file = <span class="st">"MainAnalyses.html"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(list=<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="co">#################################################</span>
</pre></div>
<p>You can see that it is organized in the order in which the scripts need to be ran and how the scripts are named.</p>
<p>The <code><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render()</a></code>, function seen in the “3. Data Analysis” section, is how to knit an RMarkdown document. We will see later that this creates a flexible way to knit RMarkdown documents because you can specify the output file name and location, as well as certain parameters for what data set to import or analysis parameters to set. <code><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render()</a></code> comes from the package <code>rmarkdown</code> which is why it is loaded at the top of the data analysis section.</p>
<hr>
</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="reproducible-practices.html"><span class="header-section-number">8</span> Reproducible Practices</a></div>
<div class="next"><a href="create-r-scripts-overview.html">Create R Scripts: Overview</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-script-templates"><span class="header-section-number">9</span> R Script Templates</a></li>
<li>
<a class="nav-link" href="#install-workflow-package"><span class="header-section-number">9.1</span> Install workflow package</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-preparation-1"><span class="header-section-number">9.1.1</span> Data Preparation</a></li>
<li><a class="nav-link" href="#messy-to-tidy-script"><span class="header-section-number">9.1.2</span> messy-to-tidy script</a></li>
<li><a class="nav-link" href="#masterscript-data-preparation"><span class="header-section-number">9.1.3</span> masterscript: Data Preparation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#data-analysis-1"><span class="header-section-number">9.2</span> Data Analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#clean-and-score-script"><span class="header-section-number">9.2.1</span> clean and score script</a></li>
<li><a class="nav-link" href="#merge-script"><span class="header-section-number">9.2.2</span> merge script</a></li>
<li><a class="nav-link" href="#masterscript-data-analysis"><span class="header-section-number">9.2.3</span> masterscript: Data Analysis</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EngleLab: useRguide</strong>" was written by Jason Tsukahara. It was last built on 2020-11-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
