<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Tutorial for the EngleLab</title>
  <meta name="description" content="This is a short R Tutorial for the EngleLab">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R Tutorial for the EngleLab" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a short R Tutorial for the EngleLab" />
  <meta name="github-repo" content="EngleLab" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Tutorial for the EngleLab" />
  
  <meta name="twitter:description" content="This is a short R Tutorial for the EngleLab" />
  

<meta name="author" content="Jason Tsukahara">


<meta name="date" content="2019-02-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="englelab-packages.html">
<link rel="next" href="example-data-preparation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I I. Getting Started in R</b></span></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a><ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>1.1</b> Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="installation.html"><a href="installation.html#installing-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installing R Studio</a></li>
<li class="chapter" data-level="1.3" data-path="installation.html"><a href="installation.html#the-r-studio-environemnt"><i class="fa fa-check"></i><b>1.3</b> The R Studio Environemnt</a></li>
<li class="chapter" data-level="1.4" data-path="installation.html"><a href="installation.html#r-studio-settings"><i class="fa fa-check"></i><b>1.4</b> R Studio Settings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>2</b> Basic R</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-r.html"><a href="basic-r.html#creating-r-objects"><i class="fa fa-check"></i><b>2.1</b> Creating R objects</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basic-r.html"><a href="basic-r.html#classes"><i class="fa fa-check"></i><b>2.1.1</b> Classes</a></li>
<li class="chapter" data-level="2.1.2" data-path="basic-r.html"><a href="basic-r.html#vectors"><i class="fa fa-check"></i><b>2.1.2</b> Vectors</a></li>
<li class="chapter" data-level="2.1.3" data-path="basic-r.html"><a href="basic-r.html#factors"><i class="fa fa-check"></i><b>2.1.3</b> Factors</a></li>
<li class="chapter" data-level="2.1.4" data-path="basic-r.html"><a href="basic-r.html#lists"><i class="fa fa-check"></i><b>2.1.4</b> Lists</a></li>
<li class="chapter" data-level="2.1.5" data-path="basic-r.html"><a href="basic-r.html#data-frames"><i class="fa fa-check"></i><b>2.1.5</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basic-r.html"><a href="basic-r.html#ifthen-statements"><i class="fa fa-check"></i><b>2.2</b> If…then Statements</a></li>
<li class="chapter" data-level="2.3" data-path="basic-r.html"><a href="basic-r.html#r-packages"><i class="fa fa-check"></i><b>2.3</b> R Packages</a><ul>
<li class="chapter" data-level="2.3.1" data-path="basic-r.html"><a href="basic-r.html#installing-and-loading-r-packages"><i class="fa fa-check"></i><b>2.3.1</b> Installing and Loading R Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basic-r.html"><a href="basic-r.html#more-r-basic-resources"><i class="fa fa-check"></i><b>2.4</b> More R Basic Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intermediate-r.html"><a href="intermediate-r.html"><i class="fa fa-check"></i><b>3</b> Intermediate R</a><ul>
<li class="chapter" data-level="3.1" data-path="intermediate-r.html"><a href="intermediate-r.html#for-loops"><i class="fa fa-check"></i><b>3.1</b> For Loops</a></li>
<li class="chapter" data-level="3.2" data-path="intermediate-r.html"><a href="intermediate-r.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a><ul>
<li class="chapter" data-level="3.2.1" data-path="intermediate-r.html"><a href="intermediate-r.html#creating-your-own-functions"><i class="fa fa-check"></i><b>3.2.1</b> Creating Your Own Functions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II II. Working with Data</b></span></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Workflow</a></li>
<li class="chapter" data-level="5" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> The tidyverse</a><ul>
<li class="chapter" data-level="5.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html#readr---import"><i class="fa fa-check"></i><b>5.1</b> readr - import</a></li>
<li class="chapter" data-level="5.2" data-path="the-tidyverse.html"><a href="the-tidyverse.html#dplyr"><i class="fa fa-check"></i><b>5.2</b> dplyr</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html#rename"><i class="fa fa-check"></i><b>5.2.1</b> <code>rename()</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="the-tidyverse.html"><a href="the-tidyverse.html#filter"><i class="fa fa-check"></i><b>5.2.2</b> <code>filter()</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="the-tidyverse.html"><a href="the-tidyverse.html#select"><i class="fa fa-check"></i><b>5.2.3</b> <code>select()</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="the-tidyverse.html"><a href="the-tidyverse.html#mutate"><i class="fa fa-check"></i><b>5.2.4</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="5.2.5" data-path="the-tidyverse.html"><a href="the-tidyverse.html#group_by"><i class="fa fa-check"></i><b>5.2.5</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="5.2.6" data-path="the-tidyverse.html"><a href="the-tidyverse.html#summarise"><i class="fa fa-check"></i><b>5.2.6</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="5.2.7" data-path="the-tidyverse.html"><a href="the-tidyverse.html#spread"><i class="fa fa-check"></i><b>5.2.7</b> <code>spread()</code></a></li>
<li class="chapter" data-level="5.2.8" data-path="the-tidyverse.html"><a href="the-tidyverse.html#pipe-operator"><i class="fa fa-check"></i><b>5.2.8</b> Pipe Operator %&gt;%</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-tidyverse.html"><a href="the-tidyverse.html#readr---export"><i class="fa fa-check"></i><b>5.3</b> readr - export</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>6</b> Transformations</a><ul>
<li class="chapter" data-level="6.1" data-path="transformations.html"><a href="transformations.html#descriptive-statistics"><i class="fa fa-check"></i><b>6.1</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="6.2" data-path="transformations.html"><a href="transformations.html#centering-and-standardizing-variables"><i class="fa fa-check"></i><b>6.2</b> Centering and Standardizing Variables</a></li>
<li class="chapter" data-level="6.3" data-path="transformations.html"><a href="transformations.html#transformations-1"><i class="fa fa-check"></i><b>6.3</b> Transformations</a><ul>
<li class="chapter" data-level="6.3.1" data-path="transformations.html"><a href="transformations.html#log"><i class="fa fa-check"></i><b>6.3.1</b> log</a></li>
<li class="chapter" data-level="6.3.2" data-path="transformations.html"><a href="transformations.html#polynomial"><i class="fa fa-check"></i><b>6.3.2</b> polynomial</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="transformations.html"><a href="transformations.html#composites"><i class="fa fa-check"></i><b>6.4</b> Composites</a></li>
<li class="chapter" data-level="6.5" data-path="transformations.html"><a href="transformations.html#custom-transformations"><i class="fa fa-check"></i><b>6.5</b> Custom Transformations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="englelab-packages.html"><a href="englelab-packages.html"><i class="fa fa-check"></i><b>7</b> EngleLab Packages</a><ul>
<li class="chapter" data-level="7.1" data-path="englelab-packages.html"><a href="englelab-packages.html#englelab"><i class="fa fa-check"></i><b>7.1</b> englelab</a><ul>
<li class="chapter" data-level="7.1.1" data-path="englelab-packages.html"><a href="englelab-packages.html#tidy-raw-data-functions"><i class="fa fa-check"></i><b>7.1.1</b> “tidy” raw data functions</a></li>
<li class="chapter" data-level="7.1.2" data-path="englelab-packages.html"><a href="englelab-packages.html#score-data-functions"><i class="fa fa-check"></i><b>7.1.2</b> score data functions</a></li>
<li class="chapter" data-level="7.1.3" data-path="englelab-packages.html"><a href="englelab-packages.html#calculating-bin-scores"><i class="fa fa-check"></i><b>7.1.3</b> Calculating Bin Scores</a></li>
<li class="chapter" data-level="7.1.4" data-path="englelab-packages.html"><a href="englelab-packages.html#reliability-functions"><i class="fa fa-check"></i><b>7.1.4</b> Reliability functions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="englelab-packages.html"><a href="englelab-packages.html#datawrangling"><i class="fa fa-check"></i><b>7.2</b> datawrangling</a><ul>
<li class="chapter" data-level="7.2.1" data-path="englelab-packages.html"><a href="englelab-packages.html#merging-data-files"><i class="fa fa-check"></i><b>7.2.1</b> Merging Data Files</a></li>
<li class="chapter" data-level="7.2.2" data-path="englelab-packages.html"><a href="englelab-packages.html#reshpaing-data"><i class="fa fa-check"></i><b>7.2.2</b> Reshpaing Data</a></li>
<li class="chapter" data-level="7.2.3" data-path="englelab-packages.html"><a href="englelab-packages.html#transformations-2"><i class="fa fa-check"></i><b>7.2.3</b> Transformations</a></li>
<li class="chapter" data-level="7.2.4" data-path="englelab-packages.html"><a href="englelab-packages.html#data-cleaning"><i class="fa fa-check"></i><b>7.2.4</b> Data Cleaning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html"><i class="fa fa-check"></i><b>8</b> Organization and Good Practices</a><ul>
<li class="chapter" data-level="8.1" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#create_study"><i class="fa fa-check"></i><b>8.1</b> create_study()</a><ul>
<li class="chapter" data-level="8.1.1" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#before-data-collection"><i class="fa fa-check"></i><b>8.1.1</b> Before data collection</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#working-directory"><i class="fa fa-check"></i><b>8.2</b> Working Directory</a><ul>
<li class="chapter" data-level="8.2.1" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#r-projects"><i class="fa fa-check"></i><b>8.2.1</b> R Projects</a></li>
<li class="chapter" data-level="8.2.2" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#here"><i class="fa fa-check"></i><b>8.2.2</b> here()</a></li>
<li class="chapter" data-level="8.2.3" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#summary"><i class="fa fa-check"></i><b>8.2.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#taskname1_raw.r"><i class="fa fa-check"></i><b>8.3</b> 1_taskname1_raw.R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#setup"><i class="fa fa-check"></i><b>8.3.1</b> Setup</a></li>
<li class="chapter" data-level="8.3.2" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#import-data"><i class="fa fa-check"></i><b>8.3.2</b> Import data</a></li>
<li class="chapter" data-level="8.3.3" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#clean-up-raw-data-file"><i class="fa fa-check"></i><b>8.3.3</b> Clean up raw data file</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#taskname1_score.r"><i class="fa fa-check"></i><b>8.4</b> 2_taskname1_score.R</a></li>
<li class="chapter" data-level="8.5" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#masterscript-template"><i class="fa fa-check"></i><b>8.5</b> Masterscript template</a></li>
<li class="chapter" data-level="8.6" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#r-scripts"><i class="fa fa-check"></i><b>8.6</b> R Scripts</a><ul>
<li class="chapter" data-level="8.6.1" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#general-workflow"><i class="fa fa-check"></i><b>8.6.1</b> General Workflow</a></li>
<li class="chapter" data-level="8.6.2" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#building-a-template-workflow"><i class="fa fa-check"></i><b>8.6.2</b> Building a Template Workflow</a></li>
<li class="chapter" data-level="8.6.3" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#rmlistls"><i class="fa fa-check"></i><b>8.6.3</b> rm(list=ls())</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#the-masterscript"><i class="fa fa-check"></i><b>8.7</b> The masterscript</a></li>
<li class="chapter" data-level="8.8" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#folder-organization"><i class="fa fa-check"></i><b>8.8</b> Folder Organization</a></li>
<li class="chapter" data-level="8.9" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#naming-r-scripts"><i class="fa fa-check"></i><b>8.9</b> Naming R Scripts</a></li>
<li class="chapter" data-level="8.10" data-path="organization-and-good-practices.html"><a href="organization-and-good-practices.html#summary-1"><i class="fa fa-check"></i><b>8.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="example-data-preparation.html"><a href="example-data-preparation.html"><i class="fa fa-check"></i><b>9</b> Example: Data Preparation</a><ul>
<li class="chapter" data-level="9.1" data-path="example-data-preparation.html"><a href="example-data-preparation.html#initial-setup"><i class="fa fa-check"></i><b>9.1</b> Initial Setup</a><ul>
<li class="chapter" data-level="9.1.1" data-path="example-data-preparation.html"><a href="example-data-preparation.html#set-up-directory-structure"><i class="fa fa-check"></i><b>9.1.1</b> Set up directory structure</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="example-data-preparation.html"><a href="example-data-preparation.html#masterscript"><i class="fa fa-check"></i><b>9.2</b> Masterscript</a></li>
<li class="chapter" data-level="9.3" data-path="example-data-preparation.html"><a href="example-data-preparation.html#creating-messy-merged-file"><i class="fa fa-check"></i><b>9.3</b> Creating “messy” Merged File</a><ul>
<li class="chapter" data-level="9.3.1" data-path="example-data-preparation.html"><a href="example-data-preparation.html#e-prime-2.0"><i class="fa fa-check"></i><b>9.3.1</b> E-Prime 2.0</a></li>
<li class="chapter" data-level="9.3.2" data-path="example-data-preparation.html"><a href="example-data-preparation.html#skipping-e-merge-with-e-prime-3.0"><i class="fa fa-check"></i><b>9.3.2</b> Skipping E-Merge with E-Prime 3.0</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="example-data-preparation.html"><a href="example-data-preparation.html#step-1-messy-to-tidy"><i class="fa fa-check"></i><b>9.4</b> Step 1: “messy” to “tidy”</a><ul>
<li class="chapter" data-level="9.4.1" data-path="example-data-preparation.html"><a href="example-data-preparation.html#what-to-include"><i class="fa fa-check"></i><b>9.4.1</b> What to Include</a></li>
<li class="chapter" data-level="9.4.2" data-path="example-data-preparation.html"><a href="example-data-preparation.html#import-messy-data"><i class="fa fa-check"></i><b>9.4.2</b> Import “messy” data</a></li>
<li class="chapter" data-level="9.4.3" data-path="example-data-preparation.html"><a href="example-data-preparation.html#remove-duplicate-subjects"><i class="fa fa-check"></i><b>9.4.3</b> Remove Duplicate Subjects</a></li>
<li class="chapter" data-level="9.4.4" data-path="example-data-preparation.html"><a href="example-data-preparation.html#filter-rows"><i class="fa fa-check"></i><b>9.4.4</b> Filter Rows</a></li>
<li class="chapter" data-level="9.4.5" data-path="example-data-preparation.html"><a href="example-data-preparation.html#rename-variables"><i class="fa fa-check"></i><b>9.4.5</b> Rename Variables</a></li>
<li class="chapter" data-level="9.4.6" data-path="example-data-preparation.html"><a href="example-data-preparation.html#rename-values"><i class="fa fa-check"></i><b>9.4.6</b> Rename Values</a></li>
<li class="chapter" data-level="9.4.7" data-path="example-data-preparation.html"><a href="example-data-preparation.html#select-columns"><i class="fa fa-check"></i><b>9.4.7</b> Select Columns</a></li>
<li class="chapter" data-level="9.4.8" data-path="example-data-preparation.html"><a href="example-data-preparation.html#save-to-file-2"><i class="fa fa-check"></i><b>9.4.8</b> Save to File</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="example-data-preparation.html"><a href="example-data-preparation.html#step-2-raw-tidy-to-scored"><i class="fa fa-check"></i><b>9.5</b> Step 2: raw “tidy” to scored</a><ul>
<li class="chapter" data-level="9.5.1" data-path="example-data-preparation.html"><a href="example-data-preparation.html#set-up"><i class="fa fa-check"></i><b>9.5.1</b> Set up</a></li>
<li class="chapter" data-level="9.5.2" data-path="example-data-preparation.html"><a href="example-data-preparation.html#import"><i class="fa fa-check"></i><b>9.5.2</b> Import</a></li>
<li class="chapter" data-level="9.5.3" data-path="example-data-preparation.html"><a href="example-data-preparation.html#data-cleaning-1"><i class="fa fa-check"></i><b>9.5.3</b> Data Cleaning</a></li>
<li class="chapter" data-level="9.5.4" data-path="example-data-preparation.html"><a href="example-data-preparation.html#calculate-flankereffect-on-rt-and-accuracy"><i class="fa fa-check"></i><b>9.5.4</b> Calculate FlankerEffect on RT and Accuracy</a></li>
<li class="chapter" data-level="9.5.5" data-path="example-data-preparation.html"><a href="example-data-preparation.html#remove-subjects"><i class="fa fa-check"></i><b>9.5.5</b> Remove Subjects</a></li>
<li class="chapter" data-level="9.5.6" data-path="example-data-preparation.html"><a href="example-data-preparation.html#calculate-binned-scores"><i class="fa fa-check"></i><b>9.5.6</b> Calculate Binned Scores</a></li>
<li class="chapter" data-level="9.5.7" data-path="example-data-preparation.html"><a href="example-data-preparation.html#save-data-file"><i class="fa fa-check"></i><b>9.5.7</b> Save data file</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="example-data-preparation.html"><a href="example-data-preparation.html#source-in-masterscript"><i class="fa fa-check"></i><b>9.6</b> <code>source()</code> in Masterscript</a></li>
</ul></li>
<li class="part"><span><b>III III. Data Analysis</b></span></li>
<li class="chapter" data-level="10" data-path="analyzing-data-in-r.html"><a href="analyzing-data-in-r.html"><i class="fa fa-check"></i><b>10</b> Analyzing Data in R</a><ul>
<li class="chapter" data-level="10.1" data-path="analyzing-data-in-r.html"><a href="analyzing-data-in-r.html#r-markdown"><i class="fa fa-check"></i><b>10.1</b> R Markdown</a><ul>
<li class="chapter" data-level="10.1.1" data-path="analyzing-data-in-r.html"><a href="analyzing-data-in-r.html#yaml-header"><i class="fa fa-check"></i><b>10.1.1</b> YAML header</a></li>
<li class="chapter" data-level="10.1.2" data-path="analyzing-data-in-r.html"><a href="analyzing-data-in-r.html#r-code-chunks"><i class="fa fa-check"></i><b>10.1.2</b> R code chunks</a></li>
<li class="chapter" data-level="10.1.3" data-path="analyzing-data-in-r.html"><a href="analyzing-data-in-r.html#formatted-text"><i class="fa fa-check"></i><b>10.1.3</b> Formatted text</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV IV. Regression</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-to-regression-in-r.html"><a href="introduction-to-regression-in-r.html"><i class="fa fa-check"></i><b>11</b> Introduction to Regression in R</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Tutorial for the EngleLab</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="organization-and-good-practices" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Organization and Good Practices</h1>
<p>Having organziation and implementing “good” practices will make working with and executing your R scripts much easier.</p>
<p>This is the workflow process of getting from “messy” raw data files to beautiful looking output of figures and statistical analyses.</p>
<p><img src="images/workflow.png" width="1276" /></p>
<p>Steps <strong>1</strong> and <strong>2</strong> will use a very similar workflow process and be implemented in R Scripts, which have the file extension <code>.R</code>. Step <strong>3</strong> will actually use what is called an R Markdown document, which has the file extension <code>.Rmd</code>.</p>
<div id="create_study" class="section level2">
<h2><span class="header-section-number">8.1</span> create_study()</h2>
<p>I have created a function, <code>create_study()</code>, to easily setup a directory structure on your computer, with template scripts included. This can be used either before data collection or after data collection. It will automatically create folders and template R scripts that you will need for a research project.</p>
<p>This function comes from my <code>openscience</code> package. The package contains other functions useful for making sure your study is organized in a way that makes it optimal to share your task programs, methods, materials, data files, and scripts in an open and easily accesible repository.</p>
<p>Let’s go over how to use the <code>create_study()</code> function and what template files it included.</p>
<p>First install the <code>openscience</code> package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;dr-JT/openscience&quot;</span>)</code></pre></div>
<p>Then create a folder within the root directory you are using for this tutorial. You can name it whatever you like - I’ll name mine “<strong>example study</strong>”.</p>
<p>Finally, create a new R Project file in the “<strong>example study</strong>” directory and open it.</p>
<p>File -&gt; New Project -&gt; Existing Directory -&gt; Choose Directory (Do not check the “open in new session”)</p>
<p>The working directory should be the location of the “<strong>example study</strong>” directory. Check to makes sure using <code>getwd()</code>.</p>
<div id="before-data-collection" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Before data collection</h3>
<p>If you want to set this up before data collection you can simply use the function as is.</p>
<p>Type in the console:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">openscience<span class="op">::</span><span class="kw">create_study</span>()</code></pre></div>
<p>You should now see the following directories:</p>
<hr />
<ul>
<li><p><strong>Data Files</strong>: Data files</p>
<ul>
<li><p><strong>Raw Data</strong>: “tidy” raw data files. Output of step 1 in the data processing workflow</p>
<ul>
<li><strong>messy</strong>: “messy” raw data files</li>
</ul></li>
<li><p><strong>Scored Data</strong>: Scored data files. Output of step 2 in the data processing workflow</p></li>
</ul></li>
<li><p><strong>Documents</strong>: Any documents related to the study. Including a <em>Methods</em> document</p></li>
<li><p><strong>Manuscript</strong>: Draft and Final versions of any Manuscripts submitted</p></li>
<li><p><strong>Presentations</strong>: Any presentations on the data from this study</p></li>
<li><p><strong>R Scripts</strong>: ALL R scripts and R Markdown documents used for data prep and analysis</p></li>
<li><p><strong>Results</strong>: Output of any data analyses</p>
<ul>
<li><strong>Figures</strong>: Figures created for presentations and manuscript</li>
</ul></li>
<li><p><strong>Tasks</strong>: Programmed tasks used for the study</p></li>
</ul>
<hr />
<p>To not create certain directories specify by setting the directory parameter to FALSE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">openscience<span class="op">::</span><span class="kw">create_study</span>(<span class="dt">scripts.dir =</span> <span class="ot">TRUE</span>, <span class="dt">data.dir =</span> <span class="ot">TRUE</span>, <span class="dt">raw.dir =</span> <span class="ot">TRUE</span>,
                         <span class="dt">messy.dir =</span> <span class="ot">TRUE</span>, <span class="dt">messy.name =</span> <span class="st">&quot;messy&quot;</span>,
                         <span class="dt">scored.dir =</span> <span class="ot">TRUE</span>, <span class="dt">results.dir =</span> <span class="ot">TRUE</span>,
                         <span class="dt">figures.dir =</span> <span class="ot">TRUE</span>, <span class="dt">manuscript.dir =</span> <span class="ot">TRUE</span>,
                         <span class="dt">presentations.dir =</span> <span class="ot">TRUE</span>, <span class="dt">documents.dir =</span> <span class="ot">TRUE</span>,
                         <span class="dt">other.dir =</span> <span class="kw">c</span>())</code></pre></div>
<p>There should also be the following script files</p>
<hr />
<ul>
<li><p>masterscript.R</p></li>
<li><p>R Scripts</p>
<ul>
<li><p>1_taskname1_raw.R</p></li>
<li><p>2_taskname1_score.R</p></li>
<li><p>3_merge.R</p></li>
<li><p>4_Demographics.Rmd</p></li>
</ul></li>
</ul>
<hr />
<p>To not create certain R script templates set the parameter to FALSE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">openscience<span class="op">::</span><span class="kw">create_study</span>(<span class="dt">masterscript =</span> <span class="ot">TRUE</span>, <span class="dt">rawscript =</span> <span class="ot">TRUE</span>,
                         <span class="dt">scorescript =</span> <span class="ot">TRUE</span>, <span class="dt">mergescript =</span> <span class="ot">TRUE</span>, <span class="dt">demographics =</span> <span class="ot">TRUE</span>,
                         <span class="dt">sem =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>I plan on adding more script templates in the future…</p>
<p>Before going over some of these R script templates let’s talk about the concept of a <strong>working directory</strong></p>
</div>
</div>
<div id="working-directory" class="section level2">
<h2><span class="header-section-number">8.2</span> Working Directory</h2>
<p>In R, and other programming languages, a “working directory” is a point of reference that can be used to create “relative” file paths. Instead of having to specify the entire file path to a directory (“User/Documents/DropBox/Projects/Study 1/Data Files/Raw Data”) you can use a “relative” file path starting from the “working directory”.</p>
<p>This is useful because it allows scripts to be reproducible across different systems, computers, and users. Every computer has different absolute file paths. Therefore, <strong>it is essential to use only relative file paths</strong>.</p>
<p>In this examlple, if the “working directory” was the Study 1 folder - <code>&quot;User/Documents/DropBox/Projects/Study 1/Data Files/Raw Data&quot;</code> - then a relative file path might look like <code>&quot;Data Files/Raw Data&quot;</code></p>
<p>If you need to go back one folder - into the “Projects” folder - you tpye two dots <code>&quot;../Study 2/Data Files/Raw Data&quot;</code> would take you to <code>&quot;User/Documents/DropBox/Projects/Study 2/Data Files/Raw Data&quot;</code></p>
<p>You can set the working directoy either using the R Studio GUI or using the function <code>setwd()</code>.</p>
<p>But… <strong><em>DO NOT DO THIS!</em></strong></p>
<p>This is not a good workflow practice. Especially if you use the R Studio GUI (which I won’t even tell you how to do). But even <code>setwd()</code> is a bad idea. The reason boils down to:</p>
<ol style="list-style-type: decimal">
<li><p><strong>You want to avoid any manual steps in your workflow process</strong> (using the GUI is a manual process)</p></li>
<li><p>Absolute file paths are computer and user specific. When you use <code>setwd()</code> you need to use an absolute file path. <strong>This makes your script not reproducible. And reproducibility is one of the main advantages to learning R in the first place, so don’t undermine yourself!</strong></p></li>
</ol>
<p>Okay okay… well what are <strong>good</strong> practices to set a working directory then?</p>
<p>There are two <strong>good</strong> practices that I know of and they are best used in combination.</p>
<ul>
<li>R Projects</li>
<li>here()</li>
</ul>
<div id="r-projects" class="section level3">
<h3><span class="header-section-number">8.2.1</span> R Projects</h3>
<ol style="list-style-type: decimal">
<li>Use <strong>R Projects</strong></li>
</ol>
<p>R Projects are a great way to have the working directory be automatically set. <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">Visit this page</a> for more information on how to use R Projects.</p>
<p>Basically an R Project allows you to open a fresh session of R that automatically sets the working directory to the directory where the R Project is saved. R Projects have the file extension <code>.Rproj</code>.</p>
<p>Go ahead and create an R Project for this tutorial. Navigate to File -&gt; New Project… -&gt; Choose Existing Directory if you already created an R Tutorial folder on your computer or New Directory -&gt; New Project if you have not. Create the R Project in the root folder of your R Tutorial.</p>
<p>Now exit out of R Studio. Then open R Studio by opening the R Project. You can evaluate what the working directory is by <code>getwd()</code>.</p>
<p>In your R Scripts you can now simply use relative paths from the working directory. And it doesn’t matter what directory you save your R scripts to. <strong>As long as you open the R Studio from the <code>.Rproj</code> file and not one of the script <code>.R</code> files.</strong></p>
<p>Try exiting out of R Studio and then opening R Studio by opening an <code>.R</code> script file that is not saved in the same location as your <code>.Rproj</code> file. Now evaluate the working directory <code>getwd()</code>. Oops… you see the working directory is no longer where the <code>.Rproj</code> file is saved. This is where the <code>here</code> package comes in handy.</p>
</div>
<div id="here" class="section level3">
<h3><span class="header-section-number">8.2.2</span> here()</h3>
<ol start="2" style="list-style-type: decimal">
<li>Use the <code>here()</code> function from the <strong>here</strong> package.</li>
</ol>
<p>This method is simple to use and is a great way to specify relative paths. It will allow you to open R Studio using any of your <code>.R</code> script files and maintain the some working directory as your <code>.Rproj</code> file.</p>
<p>First go ahead and install the <code>here</code> package, <code>install.packages(&quot;here&quot;)</code>.</p>
<p>For a passionate ode to the <code>here</code> package see: <a href="https://github.com/jennybc/here_here" class="uri">https://github.com/jennybc/here_here</a></p>
<p>Basically, when <code>here</code> is loaded, <code>library(here)</code>, it will search for one of two files to locate the working directory. 1) a hidden <code>.here</code> file or 2) an <code>.Rproj</code> file. It will recursively keep going backwards in directories to locate a root directory that contains one of these files.</p>
<p>The <code>.here</code> file can be created by <code>set_here()</code>, but is unnecessary if you are using the <strong>R Project</strong> method.</p>
<p>What this allows is pretty cool. Let’s say your working directory is <code>&quot;R Tutorial&quot;</code>, which is the directory where your <code>.Rproj</code> file is saved. Even if you have an <code>.R</code> script saved in <code>&quot;R Tutorial/A folder/R scripts/scriptexample.R&quot;</code>, you can open a new fresh session of R by opening the file. If you load <code>library(here)</code> at the top of the <code>scriptexample.R</code> file then it will automatically set the working directory to <code>&quot;R Tutorial&quot;</code> since it will detect an <code>.Rproj</code> file in that directory. Then tomorrow maybe you want to work on a different <code>.R</code> script located somewhere else but still within this same project. Let’s say it is located at <code>&quot;R Tutorial/B folder/something dumb/scripts/thisisascript.R&quot;</code>. Again, you can open a new fresh session of R by opening this file <strong>AND</strong> still have the same working directory set when you load <code>library(here)</code>.</p>
<p>Then to reference a relative file path you can use <code>here()</code>. For instance</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">here</span>(<span class="st">&quot;B folder&quot;</span>, <span class="st">&quot;somethingdumb&quot;</span>, <span class="st">&quot;scripts&quot;</span>, <span class="st">&quot;thisisascript.R&quot;</span>)

<span class="co"># Or</span>

<span class="kw">here</span>(<span class="st">&quot;B folder/somethingdumb/scripts&quot;</span>, <span class="st">&quot;thisisascript.R&quot;</span>)</code></pre></div>
<p>Bothe of these will give you the same relative file path</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="st">&quot;B folder/somethingdumb/scripts/thisisascript.R&quot;</span></code></pre></div>
<p>I think this is pretty amazing because, again, it allows you to focus on the meat of your script rather than fidling around with file paths and working directories. You don’t have to remember to open the <code>.Rproj</code> every time you want to work on writing a <code>.R</code> script. You can sipmly open the <code>.R</code> script and it just works.</p>
<p>This also makes it much easier to share projects with others or to collaborate on R scripts for a project with your colleagues.</p>
</div>
<div id="summary" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Summary</h3>
<ul>
<li><p>Use R Projects</p></li>
<li><p>Load the <code>here</code> package at the top of scripts</p></li>
<li><p>Use <code>here()</code> to reference files or file paths</p>
<p>Example: <code>read_csv(here(&quot;filepath&quot;, &quot;filename&quot;))</code></p></li>
</ul>
<hr />
<p>Now let’s cover some of the R script templates downloaded with <code>create_study()</code></p>
</div>
</div>
<div id="taskname1_raw.r" class="section level2">
<h2><span class="header-section-number">8.3</span> 1_taskname1_raw.R</h2>
<p>This template is for creating R scripts for step 1 in the data processing workflow: <strong>converting “raw” data files to “tidy” raw data files</strong></p>
<p>Which is why the file name ends with the suffix, <code>_raw.R</code>. It also has a prefix <code>1_</code> because this is the first step of data processing. The template name can be changed simply by changeing “taskname” to whatever label you want to use for the task. Example: <code>1_antisaccade_raw.R</code></p>
<p>Open the template file. You should see the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set up ####
## Load packages
<span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(here)
<span class="kw">library</span>(datawrangling)

## Set import/output directories
directories &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">here</span>(<span class="st">&quot;directories.rds&quot;</span>))
import.dir &lt;-<span class="st"> </span>directories<span class="op">$</span>messy
output.dir &lt;-<span class="st"> </span>directories<span class="op">$</span>raw

## Set import/output files
task &lt;-<span class="st"> &quot;taskname1&quot;</span>
import.file &lt;-<span class="st"> </span><span class="kw">paste</span>(task, <span class="st">&quot;.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
output.file &lt;-<span class="st"> </span><span class="kw">paste</span>(task, <span class="st">&quot;_raw.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
##############

## Import Data
data_import &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="kw">here</span>(import.dir, import.file), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">duplicates_remove</span>(<span class="dt">taskname =</span> task, <span class="dt">output.folder =</span> <span class="kw">here</span>(output.dir, <span class="st">&quot;duplicates&quot;</span>))

## Clean up raw data
data_raw &lt;-<span class="st"> </span>data_import <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>()

## Save to file
<span class="kw">write_csv</span>(data_raw, <span class="kw">here</span>(output.dir, output.file), <span class="dt">na =</span> <span class="st">&quot;&quot;</span>)

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre></div>
<p>The organization of this script is:</p>
<ul>
<li><p>Setup</p>
<ul>
<li><p>Load packages</p></li>
<li><p>Set import/output directories</p></li>
<li><p>Set import/output files</p></li>
</ul></li>
<li><p>Import data</p></li>
<li><p>Clean up raw data file</p></li>
<li><p>Save to file</p></li>
</ul>
<div id="setup" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Setup</h3>
<p>It is a good practice to load any package at the very top of the script. I also like to set the import and output directories and filenames at the top as well. This makes it very easy to see what files are being imported and how the file is being saved without having to search through the lines of code. You know where this information will be contained for every script.</p>
<div id="directories" class="section level4">
<h4><span class="header-section-number">8.3.1.1</span> directories</h4>
<p>Dealing with filepaths can be annoying. Especiall if you choose to rename them, or if you share your code with someone else but they have completely different directory organization and labels.</p>
<p>A very simple way of getting around this is to save an <em>R object</em> file in the same directory as the .Rproj file. This <em>R object</em> file is created in the mastercript (see the masterscript template section) as “<strong>directories.rds</strong>”</p>
<p>This file is imported and assigned to an object in the setup section using the <code>readRDS()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">directories &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">here</span>(<span class="st">&quot;directories.rds&quot;</span>))</code></pre></div>
<p>Try accessing different filepaths in the <code>directories</code> object. For instance the file path for the “<strong>messy</strong>” raw data files is in <code>directories$messy</code></p>
<p><strong>The only thing in the Seupt section you may need to change is specifying the <code>&quot;taskname&quot;</code></strong></p>
</div>
</div>
<div id="import-data" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Import data</h3>
<p>Import the “messy” raw data file and get rid of any duplicate subject numbers in the file using the <code>duplicates_remove()</code> function from the <code>datawrangling</code> package.</p>
<p><strong>NO CHANGES NECESSARY</strong></p>
</div>
<div id="clean-up-raw-data-file" class="section level3">
<h3><span class="header-section-number">8.3.3</span> Clean up raw data file</h3>
<p>Use dplyr to clean up raw data file. Common function you will use are <code>filter()</code>, <code>mutate()</code>, and <code>select()</code>.</p>
<p><strong>This will change depending on how the task was programmed to output data</strong></p>
<div id="save-to-file" class="section level4">
<h4><span class="header-section-number">8.3.3.1</span> Save to file</h4>
<p>Save the “tidy” raw data file as a .csv file</p>
<p><strong>NO CHANGES NECESSARY</strong></p>
<p>Clean up the environment by removing all objects from the enivornment <code>rm(list=ls())</code></p>
</div>
</div>
</div>
<div id="taskname1_score.r" class="section level2">
<h2><span class="header-section-number">8.4</span> 2_taskname1_score.R</h2>
<p>This template is for creating R scripts for step 2 of the data processing workflow: <strong>scoring the tasks from the “tidy” raw data files</strong></p>
<p>The file name ends with the suffix <code>_score.R</code> and has the prefix <code>2_</code> because it is the second step in data processing.</p>
<p>Open the template file. You should see the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set up ####
## Load packages
<span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(here)

## Set import/output directories
directories &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">here</span>(<span class="st">&quot;directories.rds&quot;</span>))
import.dir &lt;-<span class="st"> </span>directories<span class="op">$</span>raw
output.dir &lt;-<span class="st"> </span>directories<span class="op">$</span>scored

## Set import/output files
task &lt;-<span class="st"> &quot;taskname1&quot;</span>
import.file &lt;-<span class="st"> </span><span class="kw">paste</span>(task, <span class="st">&quot;_raw.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
output.file &lt;-<span class="st"> </span><span class="kw">paste</span>(task, <span class="st">&quot;_Scores.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
##############

## Import Data
data_import &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">here</span>(import.dir, import.file))

## Score
data_as &lt;-<span class="st"> </span>data_import <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>()

## Save to file
<span class="kw">write_csv</span>(data_as, <span class="kw">here</span>(output.dir, output.file), <span class="dt">na =</span> <span class="st">&quot;&quot;</span>)

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre></div>
<p>The organization of this script is:</p>
<ul>
<li><p>Setup</p></li>
<li><p>Import data</p></li>
<li><p>Score</p></li>
<li><p>Save to file</p></li>
</ul>
<div id="setup-1" class="section level4">
<h4><span class="header-section-number">8.4.0.1</span> Setup</h4>
<p>The setup organization is the same as the <code>_raw.R</code> files. It may also include any <strong>data cleaning</strong> parameters you want to set. For example you may want to trim RTs using a standard deviation cutoff of 3.5</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set data cleaning
rt.trim &lt;-<span class="st"> </span><span class="fl">3.5</span></code></pre></div>
<p>This way you can easily see and modify what data cleaning methods are being used without having to search through each line of code.</p>
<p><strong>The only thing in the Seupt section you may need to change is specifying the <code>&quot;taskname&quot;</code> and any data cleaning procedures</strong></p>
</div>
<div id="import-data-1" class="section level4">
<h4><span class="header-section-number">8.4.0.2</span> Import data</h4>
<p><strong>NO CHANGES NECESSARY</strong></p>
</div>
<div id="score-data" class="section level4">
<h4><span class="header-section-number">8.4.0.3</span> Score data</h4>
<p>Use <code>dplyr</code> and other packages to score the data. Common functions you will use are <code>filter()</code>, <code>group_by()</code>, and <code>summarise()</code>.</p>
<p><strong>This will change depending on how you need to score the task</strong></p>
</div>
<div id="save-to-file-1" class="section level4">
<h4><span class="header-section-number">8.4.0.4</span> Save to file</h4>
<p><strong>NO CHANGES NECESSARY</strong></p>
</div>
</div>
<div id="masterscript-template" class="section level2">
<h2><span class="header-section-number">8.5</span> Masterscript template</h2>
</div>
<div id="r-scripts" class="section level2">
<h2><span class="header-section-number">8.6</span> R Scripts</h2>
<p>Steps <strong>1</strong> and <strong>2</strong> are all about transforming data files to create a final output file that is ready for statistical analysis.</p>
<div id="general-workflow" class="section level3">
<h3><span class="header-section-number">8.6.1</span> General Workflow</h3>
<p>Every R script you create for steps 1 and 2 will - import a file -&gt; do stuff to the dataframe -&gt; output a saved file, <strong>no more, and no less</strong>. The general workdflow in every script will look like</p>
<ol style="list-style-type: decimal">
<li><p><strong>Load</strong> required packages using <code>library()</code></p></li>
<li><p><strong>Import</strong> data file using <code>read_delim()</code> from the <code>readr</code> package</p></li>
<li><p><strong>Do stuff</strong> to the imported dataframe using <code>dplyr</code> functions, such as</p></li>
</ol>
<p><code>filter()</code>, <code>select()</code>, <code>group_by()</code>, <code>mutate()</code>, and <code>summarise()</code></p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Save</strong> dataframe to a file using <code>write_delim()</code> from <code>readr</code> or <code>write_sav()</code> from <code>haven</code></li>
</ol>
<p>Honestly there is not much more to it then that. And because your R scripts for steps 1 and 2 have the same workflow process this makes it very easy to implement a standard organization in your scripts.</p>
</div>
<div id="building-a-template-workflow" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Building a Template Workflow</h3>
<p><strong>It is good practice to load required packages at the top of your R script</strong>.</p>
<p>After loading any required packages <strong>it is good practice to assign the import and output file path directories and file names to an object at the top of your script</strong>. I use the same object name for the import file path and output file path in every R script I write. This does a couple of things:</p>
<ol style="list-style-type: decimal">
<li><p>You can easily see what the import and output directories are for an R script since it occurs at the top and in the same location with the same names for every R script.</p></li>
<li><p>You can use the exact same or nearly the same <code>read_delim()</code> and <code>write_delim()</code> lines of code for every R script. Just copy and paste. This allow me to focus on writing the meat of the R script - the <strong>Do stuff</strong> step in the general workfolow process.</p></li>
</ol>
<p>A template R script might look something like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set up ####
## Load required packages
<span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)

## Set import and output directories
import.dir &lt;-<span class="st"> &quot;data/import&quot;</span>
output.dir &lt;-<span class="st"> &quot;data/output&quot;</span>

## Set import and output file names
import.file &lt;-<span class="st"> &quot;task.txt&quot;</span>
output.file &lt;-<span class="st"> &quot;task_Scores.txt&quot;</span>
##############

## Import data
import &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="kw">paste</span>(import.dir, import.file, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)

## Do Stuff
data &lt;-<span class="st"> </span>import <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>()

## Save data
<span class="kw">write_delim</span>(data, <span class="dt">path =</span> <span class="kw">paste</span>(ouptut.dir, output.file, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>), <span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">na =</span> <span class="st">&quot;&quot;</span>)

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre></div>
<p>Notice how I use comments to help organize the R script. <code>#</code> is how you can insert comments in the script. You can even have a hierchical structure in your comments where it will allow you to “fold” chunks of code. This is helpful if your R script is getting really long and you would like to temporarily hide chunks of code.</p>
<p>To do this you need to have a certain number of <code>#</code> at the top of the code chunk. See how I use four <code>####</code> after the <code>## Set up</code> comment. Four <code>#</code>s is usually enough. Then at the end of the code chunk I place a bunch more <code>#########</code>. You can put as many as you want, but again usually 4 is enough. I like to make it the same length as the the top of the code chunk.</p>
</div>
<div id="rmlistls" class="section level3">
<h3><span class="header-section-number">8.6.3</span> rm(list=ls())</h3>
<p><strong>It is good practice to clear out any objects in the Enviroment window before or after running a script.</strong></p>
<p>To do this you can use <code>rm(list=ls())</code>. Use this as either the first or last line of code in every R Script.</p>
<hr />
<p>Every R script you write can have this same layout That is, everything on the “left” side (of the assignment operator <code>&lt;-</code>) can stay the exactly same. Whereas what happens on the “right” side depends on what data file you are working with. But even what is happening on the “right” side is similar and may only require the <code>readr</code> and <code>dplyr</code> packages. My actual template R script looks slightly different but I have to first explain working directories and more good practices to use when writing scripts in R.</p>
<p>Using <code>here()</code> we can slightly modify the R script template from above to look like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Set up ####
## Load required packages
<span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)

## Set import and output directories
import.dir &lt;-<span class="st"> &quot;data/import&quot;</span>
output.dir &lt;-<span class="st"> &quot;data/output&quot;</span>

## Set import and output file names
import.file &lt;-<span class="st"> &quot;task.txt&quot;</span>
output.file &lt;-<span class="st"> &quot;task_Scores.txt&quot;</span>
##############

## Import data
import &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="kw">here</span>(import.dir, import.file), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)

## Do Stuff
data &lt;-<span class="st"> </span>import <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>()

## Save data
<span class="kw">write_delim</span>(data, <span class="dt">path =</span> <span class="kw">here</span>(ouptut.dir, output.file), <span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">na =</span> <span class="st">&quot;&quot;</span>)

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre></div>
<p>Rather than using <code>paste()</code> you can simply use <code>here()</code>. And if you are using the <strong>R Project</strong> method, then it will automatically set the working directory based on where <code>.Rproj</code> is saved.</p>
<p>Go ahead and set up an R Tutorial <code>.Rproj</code> file and modify your R script from the previous chapter to implement <code>here()</code>.</p>
<p><strong>Anywhere you specify a filepath you should be using the <code>here()</code> function</strong>. <code>here(&quot;file/path&quot;, &quot;filename&quot;)</code>.</p>
</div>
</div>
<div id="the-masterscript" class="section level2">
<h2><span class="header-section-number">8.7</span> The masterscript</h2>
<p>I like to use a masterscript that runs multiple R scripts one after another. I started doing this just to keep my sanity. In our lab we often times have many many tasks that we need to analyze data from. Well it can get a little crazy trying to keep all the R scripts organized and running the scripts in the correct order. Using a masterscript can help with this.</p>
<p>The <code>source()</code> function will execute all the lines of code in an R script. You simply specify the file path of the R script, such as <code>source(&quot;scripts/A_script.R&quot;)</code>.</p>
<p>Your masterscript might simply contain only lines of code using <code>source()</code>.</p>
<p>I like to also create an object called <code>directories</code> that contains a list of the relative file paths (from the working directory).</p>
<p>A typical masterscript of mine will look like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Setup ####
## Load Packages
<span class="kw">library</span>(here)
<span class="kw">library</span>(rmarkdown)

## Specify the directory tree
directories &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">scripts =</span> <span class="st">&quot;Data Files/R Scripts&quot;</span>,
                    <span class="dt">data =</span> <span class="st">&quot;Data Files&quot;</span>,
                    <span class="dt">raw =</span> <span class="st">&quot;Data Files/Raw Data&quot;</span>,
                    <span class="dt">emerge =</span> <span class="st">&quot;Data Files/Raw Data/E-Merge&quot;</span>,
                    <span class="dt">scored =</span> <span class="st">&quot;Data Files/Scored Data&quot;</span>)

<span class="kw">saveRDS</span>(directories, <span class="kw">here</span>(<span class="st">&quot;directories.rds&quot;</span>))
#############

#################################
<span class="co">#------ &quot;messy&quot; to &quot;tidy&quot; ------#</span>
#################################

## Create raw data file from e-merged files ####
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;1_wmc_raw.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;1_gf_raw.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;1_antisaccade_raw.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;1_flanker_raw.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;1_stroop_raw.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
################################################

#################################
<span class="co">#------ Task Scoring ------#</span>
#################################

## Score task data from raw data files ####
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_wmc_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_gf_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_antisaccade_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_flanker_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_stroop_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;2_demographics_score.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
###########################################

## Merge scored files to create a single data file ####
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;Data Files/R Scripts&quot;</span>, <span class="st">&quot;3_merge.R&quot;</span>), <span class="dt">echo=</span><span class="ot">TRUE</span>)
###################################################

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre></div>
</div>
<div id="folder-organization" class="section level2">
<h2><span class="header-section-number">8.8</span> Folder Organization</h2>
<p>I suggest adopting a consistent folder organization for all your research projects. Again, this is just about allowing you to focus on the meat of your R scripts.</p>
<p>This is my organization:</p>
<p><em>Working Directory</em></p>
<ul>
<li>Data Files
<ul>
<li>Raw Data
<ul>
<li>E-Merge</li>
</ul></li>
<li>Scored Data</li>
</ul></li>
<li>R Scripts</li>
<li>Results</li>
</ul>
<p>In the <em>Data Files/Raw Data/E-Merge</em> folder are the <strong>“messy” raw data</strong> files</p>
<p>In the <em>Data Files/Raw Data</em> folder are the <strong>“tidy” raw data</strong> files</p>
<p>In the <em>Data Files/Scored Data</em> folder are the <strong>scored data</strong> files</p>
<p>In the <em>Results</em> folder are the outpued <strong>results</strong></p>
<p>In the <em>R Scripts</em> folder are ALL the R Scripts that are used</p>
<p>You can see how this organization corresponds to the data processing workflow I introduced earlier</p>
<p><img src="images/workflow.png" width="1276" /></p>
</div>
<div id="naming-r-scripts" class="section level2">
<h2><span class="header-section-number">8.9</span> Naming R Scripts</h2>
<p>If you have a lot of R Scripts for a project it can make it easier to use a certain naming convention to organize the scripts. <strong>First of all, I definitely reccomend putting all your scripts into one folder.</strong> There is nothing more annoying then having to search all of your computer for the script you are looking for.</p>
<p>I personally like to name my R scripts with a number prefix folowed by an underscore and end it with the name of the data processing step it belongs to (i.e. <code>1_taskname_raw.R</code>).</p>
<p>The numbered prefix denotes what step in the data processing procedure given the organization of the masterscript.</p>
<p>This makes it SO MUCH easier to search for the script you need to work on. For instance, my R Script directory might look like</p>
<p><img src="images/folder-organization.png" width="491" /></p>
<p>Where all the scripts that create “tidy” raw data files have the prefix <code>1</code> and the suffix <code>_raw</code> whereas the scripts for scoring data files has the prefix <code>2</code> and the suffix <code>_score</code>. The prefix number will order the scripts by their data processing workflow step.</p>
</div>
<div id="summary-1" class="section level2">
<h2><span class="header-section-number">8.10</span> Summary</h2>
<ul>
<li><p>Every R Script should import a file -&gt; Do stuff to the dataframe -&gt; output a saved file. No more, no less than that.</p></li>
<li><p>At the top of your R script:</p>
<p>Load required packages with <code>library()</code></p>
<p>Set the import and output directories and filenames</p></li>
<li><p>Clear out all objects in the Environment using <code>rm(list=ls())</code></p></li>
<li><p>Make your R Scripts reproducible by:</p>
<p>Avoid using manual steps</p>
<p>Use only relative file paths</p>
<p>Using <strong>R Projects</strong></p>
<p>Using <code>here()</code></p></li>
<li><p>Create your own template or use my template workflow</p></li>
<li><p>Use a masterscript</p></li>
<li><p>Put all R Scripts for a project in one file</p></li>
<li><p>Create naming conventions that match the data processing steps in the masterscript</p></li>
</ul>
<hr />
<p>In the next two chapters we will go over an example of writing R Scripts for steps 1 and 2 of the general data processing workflow.</p>
<p>If you have not doen so already, you should create an <code>.Rproj</code> and organize your folders.</p>
<p>If you would like to use a similar workflow in your R Scripts as I do, you can check out the <a href="https://github.com/dr-JT/englelab/tree/master/rscript_templates">R Script templates I have created for the Engle lab</a>.</p>
<hr />
<p><strong>Now let’s apply everything you have learned so far using an example data set</strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="englelab-packages.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-data-preparation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper", "github"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
