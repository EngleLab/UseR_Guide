<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>16 Introduction to ggplot2 | EngleLab: useRguide</title>
<meta name="author" content="Jason Tsukahara">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EngleLab: useRguide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Getting Started in R</li>
<li><a class="" href="installation.html"><span class="header-section-number">1</span> Installation</a></li>
<li><a class="" href="basic-r.html"><span class="header-section-number">2</span> Basic R</a></li>
<li><a class="" href="intermediate-r.html"><span class="header-section-number">3</span> Intermediate R</a></li>
<li class="book-part">Working with Data</li>
<li><a class="" href="working-with-data-overview.html">Working with Data: Overview</a></li>
<li><a class="" href="importing-and-outputing-data.html"><span class="header-section-number">4</span> Importing and Outputing Data</a></li>
<li><a class="" href="data-manipulation-using-dplyr.html"><span class="header-section-number">5</span> Data Manipulation using dplyr</a></li>
<li><a class="" href="common-data-manipulations.html"><span class="header-section-number">6</span> Common Data Manipulations</a></li>
<li class="book-part">Reproducible Workflows</li>
<li><a class="" href="reproducible-workflows-overview.html">Reproducible Workflows: Overview</a></li>
<li><a class="" href="project-organization.html"><span class="header-section-number">7</span> Project Organization</a></li>
<li><a class="" href="reproducible-practices.html"><span class="header-section-number">8</span> Reproducible Practices</a></li>
<li><a class="" href="r-script-templates.html"><span class="header-section-number">9</span> R Script Templates</a></li>
<li class="book-part">Create R Scripts</li>
<li><a class="" href="create-r-scripts-overview.html">Create R Scripts: Overview</a></li>
<li><a class="" href="data-preparation-setup.html"><span class="header-section-number">10</span> Data Preparation: Setup</a></li>
<li><a class="" href="data-preparation-messy-to-tidy.html"><span class="header-section-number">11</span> Data Preparation: Messy to Tidy</a></li>
<li><a class="" href="data-analysis-setup.html"><span class="header-section-number">12</span> Data Analysis: Setup</a></li>
<li><a class="" href="data-analysis-tidy-to-scored.html"><span class="header-section-number">13</span> Data Analysis: Tidy to Scored</a></li>
<li><a class="" href="data-analysis-single-merged-file.html"><span class="header-section-number">14</span> Data Analysis: Single Merged File</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="data-visualization-overview.html">Data Visualization: Overview</a></li>
<li><a class="" href="fundamentals-of-data-visualization.html"><span class="header-section-number">15</span> Fundamentals of Data Visualization</a></li>
<li><a class="active" href="introduction-to-ggplot2.html"><span class="header-section-number">16</span> Introduction to ggplot2</a></li>
<li><a class="" href="scatterplots.html"><span class="header-section-number">17</span> Scatterplots</a></li>
<li><a class="" href="plotting-means.html"><span class="header-section-number">18</span> Plotting Means</a></li>
<li><a class="" href="univariate-plots.html"><span class="header-section-number">19</span> Univariate Plots</a></li>
<li class="book-part">Statistical Analysis</li>
<li><a class="" href="statistical-analysis-overview.html">Statistical Analysis: Overview</a></li>
<li><a class="" href="statistics-in-r.html"><span class="header-section-number">20</span> Statistics in R</a></li>
<li><a class="" href="structural-equation-modelling.html"><span class="header-section-number">21</span> Structural Equation Modelling</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction-to-ggplot2" class="section level1">
<h1>
<span class="header-section-number">16</span> Introduction to ggplot2<a class="anchor" aria-label="anchor" href="#introduction-to-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/ggplot2.jpg" width="125" style="display: block; margin: auto;"></div>
<div id="grammar-of-graphics-1" class="section level2">
<h2>
<span class="header-section-number">16.1</span> Grammar of Graphics<a class="anchor" aria-label="anchor" href="#grammar-of-graphics-1"><i class="fas fa-link"></i></a>
</h2>
<p>We saw from the last chapter that the two main components in a grammar of graphics are:</p>
<ol style="list-style-type: decimal">
<li><p>Graphics = distinct <em>layers</em> of grammatical elements</p></li>
<li><p>Meaningful plots through aesthetic mappings</p></li>
</ol>
<p>We also saw that the three essential elements are the data layer, aesthetics layer, and geometrics layer. In ggplot2 there are a total of 7 layers we can add to a plot</p>
<div class="inline-figure"><img src="images/dataviz/ge_all.png" width="846" style="display: block; margin: auto;"></div>
</div>
<div id="data-layer" class="section level2">
<h2>
<span class="header-section-number">16.2</span> Data layer<a class="anchor" aria-label="anchor" href="#data-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The Data Layer specifies the data being plotted.</p>
<div class="inline-figure"><img src="images/dataviz/ge_data.png" width="300" style="display: block; margin: auto;"></div>
<p>Let’s see what this means more concretely with an example data set. A very popular data set used for teaching data science is the <code>iris</code> data set. In this data set various species of iris were measured on their sepal and petal length and width.</p>
<p>This data set actually comes pre-loaded with R, so you can simply view it by typing in your console</p>
<div class="sourceCode" id="cb281"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span>(<span class="kw">iris</span>)
</pre></div>
<div class="sourceCode" id="cb282"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">iris</span>)
</pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>We can see that this data is in <strong>wide</strong> format. What type of graph we can visualize will depend on the format of the data set. On occasion, in order to visualize a certain pattern of the data will require you to change the formatting of the data.</p>
<p>Let’s go ahead and start building our graphical elements in <code>ggplot2</code>. Load the <code>ggplot2</code> library. Then:</p>
<div class="sourceCode" id="cb284"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(data = <span class="kw">iris</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-326-1.png" width="672"></div>
<p>You can see that we only have a blank square. This is because we have not added any other layers yet, we have only specified the data layer.</p>
</div>
<div id="aesthetic-layer" class="section level2">
<h2>
<span class="header-section-number">16.3</span> Aesthetic Layer<a class="anchor" aria-label="anchor" href="#aesthetic-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The next grammatical element is the aesthetic layer, or <strong>aes</strong> for short. This layer specifies how we want to <em>map</em> our data onto the scales of the plot</p>
<div class="inline-figure"><img src="images/dataviz/ge_aes.png" width="300" style="display: block; margin: auto;"></div>
<p>The aesthetic layer <em>maps</em> variables in our data onto scales in our graphical visualization, such as the x and y coordinates. In <code>ggplot2</code> the aesthetic layer is specified using the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function. Let’s create a plot of the relationship between Sepal.Length and Sepal.Width, putting them on the x and y axis respectively.</p>
<div class="sourceCode" id="cb285"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">Sepal.Length</span>, y = <span class="kw">Sepal.Width</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-328-1.png" width="672"></div>
<p>You can see we went from a blank box to a graph with the variable and scales of Sepal.Length mapped onto the x-axis and Sepal.Width on the y-axis.</p>
<p>However, there is no data yet :( What are we to do?</p>
</div>
<div id="geometries-layer" class="section level2">
<h2>
<span class="header-section-number">16.4</span> Geometries Layer<a class="anchor" aria-label="anchor" href="#geometries-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The next <em>essential</em> element for data visualization is the geometries layer or <strong>geom</strong> layer for short.</p>
<div class="inline-figure"><img src="images/dataviz/ge_geom.png" width="300" style="display: block; margin: auto;"></div>
<p>Just to demonstrate to you that <code>ggplot2</code> is creating R graphic objects that you can modify and not just static images, let’s assign the previous graph with data and aesthetics layers only onto an R object called <code>p</code>, for plot.</p>
<div class="sourceCode" id="cb286"><pre class="downlit">
<span class="kw">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">Sepal.Length</span>, y = <span class="kw">Sepal.Width</span>))
</pre></div>
<p>Now let’s say we want to add the individual raw data points to create a scatterplot. To do this we can use the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>. This is a geom layer and the type of geom we want to add are points.</p>
<p>In <code>ggplot2</code> there is a special notation that is similar to the pipe operator <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> seen before. Except it is plus sign <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code></p>
<div class="sourceCode" id="cb287"><pre class="downlit">
<span class="kw">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-331-1.png" width="672"></div>
<p>And walla! Now we have a scatterplot of the relationship between Sepal.Length and Sepal.Width. Cool.</p>
<p>If we look at the scatterplot it appears that there are at least two groups or clusters of points. These clusters might represent the different species of flowers, represented in the <code>Species</code> column. There are different ways we can visualize or separate this grouping structure.</p>
<p>First, we will consider how to plot these species in separate plots within the same visualization.</p>
</div>
<div id="facets-layer" class="section level2">
<h2>
<span class="header-section-number">16.5</span> Facets Layer<a class="anchor" aria-label="anchor" href="#facets-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The facet layer allows you to create subplots within the same graphic object</p>
<div class="inline-figure"><img src="images/dataviz/ge_facet.png" width="300" style="display: block; margin: auto;"></div>
<p>The previous three layers are the <strong>essential</strong> layers. The facet layer is not essential, however given your data you may find it helps you to explore or communicate your data.</p>
<p>Let’s create facets of our scatterplot by <code>Species</code></p>
<div class="sourceCode" id="cb288"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-333-1.png" width="672"></div>
</div>
<div id="statistics-layer" class="section level2">
<h2>
<span class="header-section-number">16.6</span> Statistics Layer<a class="anchor" aria-label="anchor" href="#statistics-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The statistics layer allows you plot statistical values calculated from the data</p>
<div class="inline-figure"><img src="images/dataviz/ge_stats.png" width="300" style="display: block; margin: auto;"></div>
<p>So far we have only plotted the raw data values. However, we may be interested in plotting some statistics or calculated values, such as a regression line, means, standard error bars, etc.</p>
<p>Let’s add a regression line to the scatterplot. First without the facet layer then with the facet layer</p>
<div class="sourceCode" id="cb289"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-335-1.png" width="672"></div>
<div class="sourceCode" id="cb290"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-336-1.png" width="672"></div>
</div>
<div id="coordinates-layer" class="section level2">
<h2>
<span class="header-section-number">16.7</span> Coordinates Layer<a class="anchor" aria-label="anchor" href="#coordinates-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The coordinate layer allows you to adjust the x and y coordinates</p>
<div class="inline-figure"><img src="images/dataviz/ge_coord.png" width="300" style="display: block; margin: auto;"></div>
<p>You can adjust the min and max values, as well as the major ticks. This is more useful when you have separate graphs (non-faceted) and you want to plot them on the same scale for comparison.</p>
<p>This is actually a very important design principle in data visualization. <strong>If you want to compare two separate graphs, then they need to be on the same scale!!!</strong></p>
<div class="sourceCode" id="cb291"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">iris</span>, <span class="kw">Species</span> <span class="op">==</span> <span class="st">"setosa"</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-338-1.png" width="672"></div>
<div class="sourceCode" id="cb292"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">iris</span>, <span class="kw">Species</span> <span class="op">==</span> <span class="st">"versicolor"</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>)
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-339-1.png" width="672"></div>
<div class="sourceCode" id="cb293"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">iris</span>, <span class="kw">Species</span> <span class="op">==</span> <span class="st">"setosa"</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">8</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-340-1.png" width="672"></div>
<div class="sourceCode" id="cb294"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">iris</span>, <span class="kw">Species</span> <span class="op">==</span> <span class="st">"versicolor"</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">8</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-341-1.png" width="672"></div>
<div class="sourceCode" id="cb295"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">iris</span>, <span class="kw">Species</span> <span class="op">==</span> <span class="st">"virginica"</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">8</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">5</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-342-1.png" width="672"></div>
<ul>
<li>Just a note. I highly suggest not using <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous()</a></code> functions. The <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian()</a></code> function is like zooming in and out of the plot area. The <code>scale_</code> functions actually change the shape of the data and statistics layers. If a data point falls outside of the <code>scale</code> limits then it will be removed from any statistical analyses (even if the individual data points are not plotted <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>)</li>
</ul>
</div>
<div id="themes-layer" class="section level2">
<h2>
<span class="header-section-number">16.8</span> Themes Layer<a class="anchor" aria-label="anchor" href="#themes-layer"><i class="fas fa-link"></i></a>
</h2>
<p>The Themes Layer refers to all non-data ink.</p>
<div class="inline-figure"><img src="images/dataviz/ge_themes.png" width="300" style="display: block; margin: auto;"></div>
<p>You can change the labels of x or y axis, add a plot title, modify a legend title, add text anywhere on the plot, change the background color, axis lines, plot lines, etc.</p>
<p>There are three types of elements within the Themes Layer; text, line, and rectangle. Together these three elements can control all the non-data ink in the graph. Underneath these three elements are sub-elements and this can be represented in a hierarchy such as:</p>
<div class="inline-figure"><img src="images/dataviz/theme_elements.png" width="300" style="display: block; margin: auto;"></div>
<p>For instance, you can see that you can control the design of the text for the plot title and legend title <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme(title = element_text())</a></code> or individually with <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme(plot.title = element_text(), legend.title = element_text())</a></code>.</p>
<ul>
<li><p>Any text element can be modified with <code><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text()</a></code></p></li>
<li><p>Any line element can be modified with <code><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line()</a></code></p></li>
<li><p>Any rect element can be modified with <code><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect()</a></code></p></li>
</ul>
<p>You can then control different features such as the color, linetype, size, font family, etc.</p>
<div class="inline-figure"><img src="images/dataviz/element_func.png" width="300" style="display: block; margin: auto;"></div>
<p>As an example let’s change some theme elements to our facet plot. Let’s change the axis value labels to <strong>red</strong> font and increase the <strong>size</strong></p>
<div class="sourceCode" id="cb296"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(color = <span class="st">"red"</span>, size = <span class="fl">14</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-346-1.png" width="672"></div>
<p>Now let’s only change the x-axis text and not the y-axis text.</p>
<div class="sourceCode" id="cb297"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(color = <span class="st">"red"</span>, size = <span class="fl">14</span>))
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-347-1.png" width="672"></div>
<p>It is a good idea to have a consistent theme across all your graphs. And so you might want to just create a theme object that you can add to all your graphs.</p>
<div class="sourceCode" id="cb298"><pre class="downlit">
<span class="kw">a_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(color = <span class="st">"red"</span>, size = <span class="fl">14</span>),
                 panel.grid = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
                 panel.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(fill = <span class="st">"pink"</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(color = <span class="st">"red"</span>, size = <span class="fl">14</span>)) <span class="op">+</span>
  <span class="kw">a_theme</span>
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-348-1.png" width="672"></div>
<div id="built-in-themes" class="section level3">
<h3>
<span class="header-section-number">16.8.1</span> Built-in Themes<a class="anchor" aria-label="anchor" href="#built-in-themes"><i class="fas fa-link"></i></a>
</h3>
<p>For the most part you can probably avoid the <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code> function by using built-in themes, unless there is a specific element you want to modify.</p>
<div class="sourceCode" id="cb299"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text.x = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(color = <span class="st">"red"</span>, size = <span class="fl">14</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span>()
</pre></div>
<div class="inline-figure"><img src="EngleLab-useRguide_files/figure-html/unnamed-chunk-349-1.png" width="672"></div>
<p>You can also set a default theme for the rest of your ggplots at the top of your script. That way you do not have to keep on specifying the theme for evey ggplot.</p>
<div class="sourceCode" id="cb300"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span>())
</pre></div>
<p>Now you can create a ggplot with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw()</a></code> without specifying <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw()</a></code> every single time.</p>
<div class="sourceCode" id="cb301"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">Sepal.Length</span>, <span class="kw">Sepal.Width</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="kw">Species</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span>(method = <span class="st">"lm"</span>, se = <span class="fl">FALSE</span>)
</pre></div>
<p>You can do a google search to easily find different types of theme templates. I personally like <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw()</a></code></p>
<hr>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="fundamentals-of-data-visualization.html"><span class="header-section-number">15</span> Fundamentals of Data Visualization</a></div>
<div class="next"><a href="scatterplots.html"><span class="header-section-number">17</span> Scatterplots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-to-ggplot2"><span class="header-section-number">16</span> Introduction to ggplot2</a></li>
<li><a class="nav-link" href="#grammar-of-graphics-1"><span class="header-section-number">16.1</span> Grammar of Graphics</a></li>
<li><a class="nav-link" href="#data-layer"><span class="header-section-number">16.2</span> Data layer</a></li>
<li><a class="nav-link" href="#aesthetic-layer"><span class="header-section-number">16.3</span> Aesthetic Layer</a></li>
<li><a class="nav-link" href="#geometries-layer"><span class="header-section-number">16.4</span> Geometries Layer</a></li>
<li><a class="nav-link" href="#facets-layer"><span class="header-section-number">16.5</span> Facets Layer</a></li>
<li><a class="nav-link" href="#statistics-layer"><span class="header-section-number">16.6</span> Statistics Layer</a></li>
<li><a class="nav-link" href="#coordinates-layer"><span class="header-section-number">16.7</span> Coordinates Layer</a></li>
<li>
<a class="nav-link" href="#themes-layer"><span class="header-section-number">16.8</span> Themes Layer</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#built-in-themes"><span class="header-section-number">16.8.1</span> Built-in Themes</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EngleLab: useRguide</strong>" was written by Jason Tsukahara. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
