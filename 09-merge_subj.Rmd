# Merging Individual Subject Files

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

```{r include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

----
<div style="text-align: center; font-size: 1.25em">
This Chapter is not Required
</div>
----


For the most part, you will merge individual subject files through the *E-Merge* program because the individual files are in the proprietary *.edat2* file type that cannot be opened outside of *E-Prime* programs.

However, there may be cases where you have individual subject files not in *.edat2* but in *.txt*, *.csv*, or *.xlsx* file types. These can easily be merged into one data file using R. 

While in the middle of data collection you may want to look at your data or run some analysis. In that case, each time you want to do so you will need to merge individual subject data files. Again, usually we do this through the manual and tedious process of *E-Merge*.

Once you are finished with data collection you will only have to merge individual subject data files one last time. 

This step is sort of a precursor to data processing and in R we can write a script for this step separately, if needed.

----
<div style="text-align: center; font-size: 1.25em">
<i class="fas fa-save" style="font-size: 3em"></i> 

Save a new R script file as `._study_finish.R` in the *R Scripts* folder

</div>
----

I have created a function to easily merge individual subject files together. The `files_bind()` function comes from my `datawrangling` package. To install `datawrangling` you first need to install `devtools`. If you have not done so already, install `devtools` by typing in your console window

```{r eval=FALSE}
install.package("devtools")
```

Now install `datawrangling` by typing in your console window

```{r eval=FALSE}
devtools::install_github("dr-JT/datawrangling")
```

## Setup

----
<div style="text-align: center; font-size: 1.25em">

Source the masterscript

</div>
----

After sourcing the masterscript you should see a new file in your project's *root* directory called `directiories.rds`. For now don't do anything with it but just be aware that it is there.

First, at the top of your script load the required packages and import the `directories.rds` file

```{r}
library(here)
library(datawrangling)

directories <- readRDS(here("directories.rds"))
```

For now you do not need to know how the `here` package works. I will talk about it more in the next Chapter and explain why we use it more in Chapter 14.

## `files_bind()`

See **Chapter 5: Importing and Outputing Data** for more detailed information on `file_bind()`. The arguments you need to specify in `files_bind()` are:

* __path__: The file path where the data are located

* __delim__: The delimiter or filetype of the data files. (i.e. `"\t" for tab-delimited)

* __output.file__: The filepath and filename to save the merged data file as

By default the merged file will be saved as a *.csv* file. You can change this by setting __output.delim__.

In your script enter the following line of code

```{r eval = FALSE}
datawrangling::files_bind(here(directories$messy, "subj"), 
                          delim = "\t", 
                          output.file = here(directories$raw, "Flanker.csv"))
```

The first argument `here(directories$messy, "subj")` is just specifiying the file directory path. Go ahead and type this in your console window to see how this is the case.

```{r}
here(directories$messy, "subj")
```

Again, the `here()` function will be talked more about in later Chapters.

If you have more tasks in which you need to merge individual subject data files you would then just include a similar line of code specific for that task (different file path and different filename).

----
<div style="text-align: center; font-size: 1.25em">

Source the script

</div>
----

You should now see a data file *Flanker.csv*. This is the merged *messy* raw data file. The *Flanker.txt* file is the merged *messy* raw data file that was exported from the *E-Merged* file. Therefore, these two dat files are equivalent except that one is tab-delimited and one is a comma-separated value.

In thi next Chapter you will create a *tidy* raw data file from this *messy* raw data file. I will leave it up to you which version of the *messy* raw data file you want to use. The only thing that will differ is how you import the file.

********

```{r echo=FALSE, message=FALSE, warning=FALSE}
rm(list=ls())
```

********

**Something**
