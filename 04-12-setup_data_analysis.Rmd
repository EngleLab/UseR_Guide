# Data Analysis: Setup

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

## Project Organization

Once Data Preparation is finished you will need to copy and paste the tidy raw data files from the Data Collection directory to a new Data Analysis directory 

```{r echo=FALSE, eval = TRUE, fig.align='center'}
knitr::include_graphics(rep("images/workflows/workflow_copyover.png"))
```

Ideally, there will be a *tidy* raw data file for EVERY task in the data collection directory However, you don't necessarily need EVERY task for your research project. The **Data Collection** directory will serve as an *archive* of where you should grab data files that are relevant to your research project. 

A key part of this is that you copy the *tidy* raw data files **ONLY**  from the data collection directory to a data analysis project. **You do not copy data files from one data analysis project to another!** Even if they use the same tasks.

In the EngleLab, we often conduct large-scale data collection studies in which there are many different research projects going on at once. Many of the tasks will be shared between these research projects. This means each separate project is using a lot of the same data. This can make it difficult to figure out how and at what stage to separate data processing and analysis between these studies.

If someone already created a data file, for their research project, with scored variables on a lot of the tasks that you need, **should you copy and paste that data file into your analysis project?** **NO!** 

This will undermine the reproducibility of your research project and analyses. You will also have no way of figuring out how they scored their variables, what data cleaning procedures they used, etc. There is no transparency of how they got from A (the raw data) to B (the scored data file). They simply gave you B. 

Whereas with the **Project Organization** method I outlined in **Chapter 7**, you can copy the **tidy** raw data files from the **Data Collection** directory into your **Data Analysis** directory. And if someone has already created scripts to score some of the tasks you need, you can also copy those R scripts over to your project. Now you will have A (the raw data) and the R script of how to get from A to B (the scored data file). This will give you full transparency and you can completely reproduce the analyses. 

The **Data Collection** directory is where both the *messy* and *tidy* raw data files are stored. **No data analysis steps occur in the Data Collection** directory. 

**Data analysis steps occur in the Data Analysis** directories. 

```{r echo=FALSE, eval = TRUE, out.width='60%', fig.align='center'}
knitr::include_graphics(rep("images/workflows/workflow_all.png"))
```

Data analysis is where we aggregate and score data from the tasks, conduct statistical analyses, and create data visualizations of our findings.

## Setup Data Analysis Directories

Here is an overview of how to setup a data analysis directory

In Chapter 7, we covered how to setup data collection and data analysis directories in more detail. Follow these steps to create the Data Analysis directory:

1. Open RStudio

2. File -> New Project... 

3. New Directory -> Research Study

4. Browse to where the project folder will be located and specify the project folder name

5. Choose Repository Type: data analysis

6. Select 'Create Project'

Once you create the R Project, you will see the following directory setup in the "Files" window pane in RStudio. Let's take a little time to understand this setup

```{r echo=FALSE, out.width=375, fig.align='center', eval = TRUE}
knitr::include_graphics(rep("images/workflows/dataanalysis_files.png"))
```

- **Data Files**: 

  This is where ALL the data files will be located. Within Data Files there are folders for **Raw Data** and **Scored Data**. The **Raw Data** folder will be where trial-level *tidy* raw data files will be located. From the *tidy* raw data files we will use scripts to create *scored* data files (one subject per row with columns as task scores) in the **Scored Data** folder. Eventually we will create a final *merged* data file that we will use for our main analyses that has the final set of subjects and only the relevant task scores we need for our analyses.

- **Documents**: 

  We can put any documents here related to the study and analysis plan. We might like to put a methods document in here or a document with our analysis plan. Or any articles that are relevant to the study

- **R Scripts**:

  **ALL R scripts**, with exception of the masterscript, will go in this folder. You should not put R scripts anywhere else! We will label the R scripts in a way that they can be easily organized to be consistent with the logical order that they need to be ran. 

  Scripts for *scoring* tasks will be labeled with the prefix: **1_**  and contain the suffix: **\_score.R** (e.g. 1_antisaccade_score.R). The one denotes that this is the first step in data analysis. This is where we clean/trim, remove problematic subjects, and score the task.

  The script to create a final *merged* data file that we will use for our main analyses will be labeled as: **2_merge.R** . The two denotes that this script has to be ran after the *scoring* scripts. If you organize your folder by 'Name' it will put the **\_score.R** scripts first followed by the **2_merge.R** script. This organizes your files by the order they need to be ran and makes it easy to find the script you want to edit or change.

- **Results**:

  This is where any *results* output will be saved to

- **masterscript.R**:

  Rather than opening each R script - running it - then closing out of it, opening the next script - running it - then closing out of it, and so on... you can run all of your R scripts in the masterscript. This also allows you to visualize the order of your scripts in an easy way. Also, if you choose to share your project to an open science repository this allow other researchers to quickly see your data processing workflow and the order of your R scripts.

- **.Rproj**:

  You only need to interact with this file when opening your R Project. When you want to work on your R project - **YOU SHOULD ALWAYS OPEN RSTUDIO BY OPENING THE .Rproj FILE!!!**


```{r echo=FALSE, message=FALSE, warning=FALSE}
rm(list=ls())
```


